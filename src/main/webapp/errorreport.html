<!--
  ~ Copyright (c) 2010 Automated Logic Corporation
  ~
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy
  ~ of this software and associated documentation files (the "Software"), to deal
  ~ in the Software without restriction, including without limitation the rights
  ~ to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~ copies of the Software, and to permit persons to whom the Software is
  ~ furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in
  ~ all copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  ~ IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  ~ FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  ~ AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  ~ LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  ~ THE SOFTWARE.
  -->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Modstat Error Check</title>
    <script type="text/javascript" src="jquery/jquery.js"></script>
    <script type="text/javascript" src="jquery/ui.core.js"></script>
    <script type="text/javascript" src="jquery/jquery.cookie.js"></script>

    <link rel='stylesheet' type='text/css' href='skin/ui.dynatree.css'>
    <script type="text/javascript" src="js/jquery.dynatree.js"></script>
    <!-- dyntree from http://code.google.com/p/dynatree/ -->

    <script type='text/javascript'>
    $(function(){
        // Attach the dynatree widget to an existing <div id="tree"> element
        // and pass the tree options as an argument to the dynatree() function:
        $("#tree").dynatree({
            title: "System",
            rootVisible: false,
            selectMode:1,
            autoFocus:false,

            initAjax: {
                url: "servlets/treedata",
                data: { type:'net' }
            },

            onLazyRead: function(dtnode) {
                dtnode.appendAjax({
                    url:"servlets/treedata",
                    data: {
                        id:dtnode.data.key,
                        type: 'net'
                    }
                })
            },

            onActivate: function(node) {
                $('#selection').text(node.data.path)
            },
            
            cache: false
        });

        $('#runbutton').bind('click', function() {
            var id = ''
            var node = $('#tree').dynatree('getActiveNode')
            if (node) {
                id = node.data.key
            }
            $('#status').text('Running...')
            $.get('errors.jsp?id='+escape(id), function(data) {
                $('#errors').html(data)
                $('#status').text('This can take a while')
            })
        })

    });
    </script>

    <style type="text/css">
        .spacer {
            width: 150px; }
        td {
            border: solid #bbb 1px;
            padding: 2px 3px 2px 3px;
        }
        .error { color: #911; }

        #tree {
            width:100%;
            height:200px;
            overflow:scroll;
        }

        div.ui-dynatree-container {            
            border:none;
        }
    </style>
</head>
<body>
<h1>Modstat Error Check</h1>
<div>Select the starting location: <span id="selection"></span></div>
<div id="tree"></div>

<button id="runbutton">Run Report</button>
<span id="status">This can take a while.</span>
<div id="errors"></div>
</body>
</html>